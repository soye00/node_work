<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´ì¹´ì˜¤ ë§µ + ëŒ€ê¸°ì§ˆ API</title>
    <script type="text/javascript"
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=e2e2a254b45f875ca65de396caabf107"></script>
    <style>
        #map {
            width: 100%;
            height: 500px;
        }

        #info {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ddd;
        }
    </style>
</head>

<body>

<h2>ë„ì‹œ í´ë¦­ ì‹œ ëŒ€ê¸°ì§ˆ ì •ë³´ ê°€ì ¸ì˜¤ê¸°</h2>
<div id="map"></div>
<div id="info">ë„ì‹œë¥¼ í´ë¦­í•˜ë©´ AQI ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
<!DOCTYPE html>
<div style="font-family: Arial, sans-serif; margin: 20px; background-color: #f8f9fa;">

    <h2 style="text-align: center; color: #333;">ğŸŒ ëŒ€ê¸°ì˜¤ì—¼ ì§€í‘œ ì •ë³´</h2>

    <table style="width: 100%; border-collapse: collapse; background: #fff; border-radius: 10px;
                  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); overflow: hidden;">
        <thead>
        <tr>
            <th style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd; background: #4CAF50;
                           color: white; font-weight: bold;">ì§€í‘œ</th>
            <th style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd; background: #4CAF50;
                           color: white; font-weight: bold;">ì˜ë¯¸</th>
            <th style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd; background: #4CAF50;
                           color: white; font-weight: bold;">ì£¼ìš” ì›ì¸</th>
            <th style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd; background: #4CAF50;
                           color: white; font-weight: bold;">ì¸ì²´ ì˜í–¥</th>
        </tr>
        </thead>
        <tbody>
        <tr style="background: #f2f2f2;">
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;"><strong>PM2.5</strong>
            </td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì´ˆë¯¸ì„¸ë¨¼ì§€</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ìë™ì°¨ ë°°ê¸°ê°€ìŠ¤, í™”ì„ì—°ë£Œ ì—°ì†Œ</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">íì§ˆí™˜, ì‹¬í˜ˆê´€ ì§ˆí™˜</td>
        </tr>
        <tr>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;"><strong>PM10</strong>
            </td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ë¯¸ì„¸ë¨¼ì§€</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ê³µì¥, í™©ì‚¬, ë„ë¡œ ë¨¼ì§€</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">í˜¸í¡ê¸° ì§ˆí™˜, ê¸°ê´€ì§€ ìê·¹</td>
        </tr>
        <tr style="background: #f2f2f2;">
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;"><strong>NO2</strong>
            </td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì´ì‚°í™”ì§ˆì†Œ</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ìë™ì°¨ ë°°ê¸°ê°€ìŠ¤, ê³µì¥</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì²œì‹, í ì†ìƒ</td>
        </tr>
        <tr>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;"><strong>SO2</strong>
            </td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì•„í™©ì‚°ê°€ìŠ¤</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì„íƒ„, ì„ìœ  ì—°ì†Œ</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ëˆˆ/ê¸°ê´€ì§€ ìê·¹, ì‚°ì„±ë¹„ ìœ ë°œ</td>
        </tr>
        <tr style="background: #f2f2f2;">
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;"><strong>CO</strong>
            </td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì¼ì‚°í™”íƒ„ì†Œ</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ìë™ì°¨ ë°°ê¸°ê°€ìŠ¤, ì—°ì†Œ</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ë‘í†µ, ì§ˆì‹ ìœ„í—˜</td>
        </tr>
        <tr>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;"><strong>O3</strong>
            </td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ì˜¤ì¡´</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">ë°°ê¸°ê°€ìŠ¤ + í–‡ë¹› ë°˜ì‘</td>
            <td style="padding: 12px; text-align: center; border-bottom: 1px solid #ddd;">í”¼ë¶€/í˜¸í¡ê¸° ìê·¹, ì˜¤ì¡´ ê²½ë³´</td>
        </tr>
        </tbody>
    </table>
</div>

<script>
    const API_KEY = "9473245485bdc203ba67751e7ad75cd0e2a5cdc9";  // WAQI API í‚¤ ì…ë ¥

    // 1ï¸âƒ£ ì¹´ì¹´ì˜¤ ë§µ ì´ˆê¸°í™”
    const mapContainer = document.getElementById("map");
    const mapOption = {
        center: new kakao.maps.LatLng(37.5665, 126.9780), // ì„œìš¸ ì¤‘ì‹¬
        level: 12 // ì¤Œ ë ˆë²¨
    };
    const map = new kakao.maps.Map(mapContainer, mapOption);

    // 2ï¸âƒ£ ë„ì‹œ ì¢Œí‘œ ë°ì´í„°
    let cities = [
        { name: "ì„œìš¸", lat: 37.5665, lng: 126.9780 },
        { name: "ëŒ€êµ¬", lat: 35.8714, lng: 128.6014 },
        { name: "ë¶€ì‚°", lat: 35.1796, lng: 129.0756 },
        { name: "ì¸ì²œ", lat: 37.4563, lng: 126.7052 },
        { name: "ê´‘ì£¼", lat: 35.1595, lng: 126.8526 },
        { name: "ëŒ€ì „", lat: 36.3504, lng: 127.3845 },
        { name: "ìš¸ì‚°", lat: 35.5384, lng: 129.3114 }
    ];

    cities = [...cities,
        { name: "ëŒ€êµ¬", lat: 35.8714, lng: 128.6014 }, // ëŒ€êµ¬ ì „ì²´
        { name: "ë‹¬ì„œêµ¬", lat: 35.8296, lng: 128.5328 }, // ë‹¬ì„œêµ¬
        { name: "ì¤‘êµ¬", lat: 35.8693, lng: 128.6062 }, // ì¤‘êµ¬
        { name: "ë‚¨êµ¬", lat: 35.8467, lng: 128.5971 }, // ë‚¨êµ¬
        { name: "ë™êµ¬", lat: 35.8867, lng: 128.6350 }, // ë™êµ¬
        { name: "ìˆ˜ì„±êµ¬", lat: 35.8588, lng: 128.6305 } // ìˆ˜ì„±êµ¬
    ];


    // 3ï¸âƒ£ ì§€ë„ì— ë§ˆì»¤ ì¶”ê°€
    cities.forEach(city => {
        const marker = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(city.lat, city.lng),
            map: map
        });

        // 4ï¸âƒ£ ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸ (API í˜¸ì¶œ)
        kakao.maps.event.addListener(marker, "click", function () {
            fetchAQI(city);
        });
    });

    // 5ï¸âƒ£ WAQI API í˜¸ì¶œ (ëŒ€ê¸°ì§ˆ ì •ë³´ ê°€ì ¸ì˜¤ê¸°)
    function fetchAQI(city) {
        const url = `https://api.waqi.info/feed/geo:${city.lat};${city.lng}/?token=${API_KEY}`;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                if (data.status === "ok") {
                    const aqi = data.data.aqi;
                    const pm10 = data.data.iaqi.pm10 ? data.data.iaqi.pm10.v : "N/A";
                    const pm25 = data.data.iaqi.pm25 ? data.data.iaqi.pm25.v : "N/A";
                    const no2 = data.data.iaqi.no2 ? data.data.iaqi.no2.v : "N/A";
                    const so2 = data.data.iaqi.so2 ? data.data.iaqi.so2.v : "N/A";
                    const co = data.data.iaqi.co ? data.data.iaqi.co.v : "N/A";
                    const o3 = data.data.iaqi.o3 ? data.data.iaqi.o3.v : "N/A";

                    document.getElementById("info").innerHTML = `
                            <h3>${city.name} ëŒ€ê¸°ì§ˆ ì •ë³´</h3>
                            <p><strong>AQI:</strong> ${aqi}</p>
                            <p><strong>ë¯¸ì„¸ë¨¼ì§€(PM10):</strong> ${pm10}</p>
                            <p><strong>ì´ˆë¯¸ì„¸ë¨¼ì§€(PM2.5):</strong> ${pm25}</p>
                            <p><strong>ì´ì‚°í™”ì§ˆì†Œ(NOâ‚‚):</strong> ${no2} ppb</p>
                            <p><strong>ì•„í™©ì‚°ê°€ìŠ¤(SOâ‚‚):</strong> ${so2} ppb</p>
                            <p><strong>ì¼ì‚°í™”íƒ„ì†Œ(CO):</strong> ${co} ppm</p>
                            <p><strong>ì˜¤ì¡´(Oâ‚ƒ):</strong> ${o3} ppb</p>
                        `;
                } else {
                    document.getElementById("info").innerHTML = `< p > ${city.name} ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨</p >`;
                }
            })
            .catch(error => console.error("API í˜¸ì¶œ ì˜¤ë¥˜:", error));
    }
</script>

</body>

</html>